<HTML>
<head><title>Computational biophysics</title></head>


<style type="text/css">
  div.important {color: #ff0000}
  div.code {
  background: #afd8de;
  border: #000 2px solid;
  padding: 10px;  width: 35%;
  }
</style>


<body BGCOLOR="white">
<font face="Arial" size="-1">
<a name="contents"></a>  <center><h1>Practical 4: Principal components analysis </h1></center>
<IMG align=right SRC="t4l_anim_ev1_small.gif">

<div class="code">

  
  <font color=black size=5>
    Contents
  </font>
  <UL>
    <font color=black size=3>
      <LI><a href="#intro">   Introduction </a>
      <LI><a href="#pca">  Principal components analysis of an MD simulation </a>
      <LI><a href="#exp">  Comparison to experimental structural data </a>
<!--      <LI><a href="#nma">  Optional: Normal Mode analysis </a> -->
      <LI><a href="#references"> References </a>

    </font>
  </UL>
  
</div>
<br>

<a name="intro"></a> <font color=#00c5d0 size=+1>   <h2>A. Introduction  </h2> </font>
Last time, we've simulated the dynamics of a small protein. Although a
protein's function is often intimately linked to its conformational
dynamics, it is not always straightforward to extract the functionally
relavant motions from a simulated trajectory. To illustrate this,
we will focus today on the dynamics of a small, flexible protein:
bacteriophage T4 lysozyme. Many organisms, including humans, have a
form of lysozyme. It degrades polysaccharides (sugar molecules) that
are part of bacterial cell walls and as such it has an antibacterial
function. Click <a
href=http://ase.tufts.edu/biology/MolecVisual/bio152/rightlyso.html>here</a>
<!--or <a
href=http://tutor.lscf.ucsb.edu/instdev/sears/biochemistry/tw-enz/lysozyme/HEWL/lysozyme-overview.htm>here</a> -->
for more background information on lysozyme. Download the structure of
T4 lysozyme complexed to a substrat analog (PDB code 148L) from the 
<a href=http://www.rcsb.org/pdb/> Protein Data Bank </a>, and view the
structure in pymol:

<h5> pymol 148L.pdb </h5>
highlight the substrate by typing (on the pymol prompt or in the
grapics window):
<h5> select sub,(resn nag,amu) </h5>
<h5> color red,sub </h5>
<h5> show sticks,sub </h5>

Now select the catalytic residues:
<h5>select cat,(resi 11,20,26) </h5>

<h5>color yellow,cat</h5>
<h5>show sticks,cat </h5>
Now highlight the secondary structure:
<h5>dss </h5>
<h5>show cartoon </h5>

As you can see, the substrate is almost enclosed by the protein,
with the active site (catalytic) residues buried in a groove on the
protein surface. <br> <p>
Since it would take too long to calculate a long enough MD simulation
during the course, we have prepared a simulation of the
(substrate-free) enzyme.
Now download <a href=t4l.pdb>this</a>  trajectory fragment and view it in pymol:

<h5>pymol t4l.pdb </h5>
Try out different visualisation modes in pymol to view as clearly as
possible the structure and the dynamics of the protein. Use the same
selections as above to highlight the catalytic residues and the
secondary structure and press the "play" button at the bottom right of
the main pymol window to see an animation of the simulation. <p>
<font color=red size=+1> Question: </font>
Which motions can you identify? How can you imagine those motions to
be crucial for the protein's function?<p><br>

<p>
Go back to <a href="#contents">Contents</a> 

<a name="pca"></a> <font color=#00c5d0 size=+1>   <h2>B. Principal components analysis of an MD simulation </h2> </font>

Probably, you will appreciate the difficulty of identifying 
functionally relevant motions. One of the main reasons for this is
that we see everything moving at the same time. Both local
fluctuations and collective motions occur simultaneously, which makes it
hard to distinguish the two types of motion from each other. A
principal components analysis can help in such cases, as it can
filter global, collective (often slow) motions from local, fast
motions. Download <a href=ref.pdb>ref.pdb</a> and <a
href=md1_backbone.xtc>md1_backbone.xtc</a>. To reduce the size of
the analysis, we will concentrate on the backbone only for the
analysis. 

<!--
<h5>source /usr/global/whatif/gromacs/i686-pc-linux-gnu/bin/GMXRC.bash   </h5> 
-->
<p>

Now, have a look at the raw (backbone) trajectory:
<h5>gmx trjconv -s ref.pdb -f md1_backbone.xtc -o md1.pdb -e 1000</h5>
(answer "0" when asked for a group).
<h5>pymol md1.pdb</h5>
and press the "play" button at the bottom right of the main pymol window.
Now start the principal components analysis of this trajectory. This
is done by building a so-called covariance matrix of the atomic
fluctuations. Diagonalisation of this matrix yields a set of
eigenvectors and eigenvalues, that describe collective modes of
fluctuations of the protein. The eigenvectors corresponding to the
largest eigenvalues are called "principal components", as they
represent the largest-amplitude collective motions.
<h5>gmx covar -s ref.pdb -f md1_backbone.xtc</h5>
and answer "0" twice when asked for a group.
If you issue a
<h5>ls -lrt</h5>
you'll see that g_covar has generated both eigenvalues and
eigenvectors, in files called eigenval.xvg and eigenvec.trr. View the
eigenvalue spectrum with:

<h5>xmgrace eigenval.xvg</h5>
The eigenvalues are sorted according to their size. As you can see,
there are only a few large eigenvalues, all others are relatively small.
To see what type of motion the indivudual eigenvectors correspond to,
we filter the original trajectory and project out the part along a
selected eigenvector:
<h5>gmx anaeig -s ref.pdb -f md1_backbone.xtc -filt filter1.pdb -first 1
-last 1 -skip 100</h5>
to filter the trajectory along the first eigenvector.  View the
animation with:
<h5>pymol filter1.pdb</h5>
<font color=red size=+1> Question: </font>
How would you describe this type of motion? How does it compare to the
raw trajectory?<p>
As you can see, the animation is kind of jerky. This is because the
even such large-scale motions do not occur smoothly, but
stochastically. To see a smooth animation of the motion along the
first eigenvector, we can artificially interpolate between the extreme
conformations sampled during the simulation along this eigenvector:
<h5>gmx anaeig -s ref.pdb -f md1_backbone.xtc -extr extreme1.pdb -first 1
-last 1 -nframes 30</h5>
View with:

<h5>pymol extreme1.pdb</h5>
Now repeat the last two commads for the second eigenvector.<p>
<font color=red size=+1> Question: </font>
How would you describe the motion along the first and second
eigenvector? What happens with the substrate-binding cleft in these
two motions?<p>
To see the contrast with the other eigenvectors, now repeat the above
procedure for eigenvector 20 (or 53, or any other number of your
choice). <p>
<font color=red size=+1> Question: </font>
The backbone of T4 lysozyme contains 486 atoms (162 residues and
3 backbone atoms per residue). How many eigenvectors/values would you
expect? How many eigenvalues should be exactly zero, and why? How many
should be approximately zero? <p>

For a more quantitatve analysis, we can project the trajectory onto
individual eigenvectors, and display the projections as a function of
time:
<h5>gmx anaeig -s ref.pdb -f md1_backbone.xtc -proj</h5>
<h5>xmgrace -nxy proj.xvg</h5>
<font color=red size=+1> Question: </font>
Which eigenvector displays the slowest motion? Would you consider the
simulation long enough to have sampled all relevant configurations? 
(one criterion for this is that all
sub-conformations should have been visited multiple times). <p>

Another way to visualise the sampled conformations in the subspace
spanned by the eigenvectors is a so-called two-dimensional projection:
<h5>gmx anaeig -s ref.pdb -f md1_backbone.xtc -2d -first 1 -last 2</h5>
<h5>xmgrace 2dproj.xvg</h5>
In this graph, each point represents a snapshot from the simulation,
and the distribution shows the sampled region along the first two
eigenvectors during the simulation.

<p>
Go back to <a href="#contents">Contents</a> 

<a name="exp"></a> <font color=#00c5d0 size=+1>   <h2>C. Comparison to experimental structural data </h2> </font>
<p>

We can use a PCA not only to analyse an MD simulation and extract the
main concerted motions from a trajectory, but also for a comparison of
multiple simulations or for the comparison to an ensemble of
experimental structures, in terms of dominant, collective motions.
For T4 lysozyme, a large number of x-ray structures has been determined
(if you search the PDB for "T4 lysozyme", you'll find more than 400
structures). We have collected 38 non-redundant x-ray structures of T4
lysozyme, which are all together collected in <a
href=allpdb_bb.xtc>allpdb_bb.xtc</a>. Just like on the simulated
trajectory, we can perform a PCA on the collection of experimental
structures:
<h5>gmx covar -s ref.pdb -f allpdb_bb.xtc</h5>
Again, choose "0" twice when asked for a group.
Use the g_anaeig program like above to analyse the results.<p> 
<font color=red size=+1> Question: </font>
What kind of motion is represented by the first and second
eigenvector? How does this compare to the results from the simulation? <p>
 
For a quantitative comparison of the simulation and the experimental
strutures, we'll project both the experimental structures and the
simulated structures onto the eigenvectors extracted from the x-ray
structures: 
<h5>gmx anaeig -s ref.pdb -f md1_backbone.xtc -2d md_2d.xvg -first 1 -last 2</h5>

<h5>gmx anaeig -s ref.pdb -f allpdb_bb.xtc -2d xray_2d.xvg -first 1 -last 2</h5>
<h5>xmgrace md_2d.xvg xray_2d.xvg</h5>
You now see the MD simulation in black and the x-ray structures in
red. Since the x-ray structures are independent structures, it is
confusing to have them connected by lines, which suggests a continuous
path between them. In xmgrace, double click on one of the data points
inside the plot, select the second set (G0.S1), under 'line
properties', select 'none', and under 'symbol properties', select
'circle', and press 'Accept'. As you will have seen, eigenvector 1 of
the x-ray ensemble describes an opening motion similar to the
animation on the top-right of this screen, whereas the second
eigenvector describes a twisting motion of both domains with respect
to each other. <p>
<font color=red size=+1> Question: </font>
How do the x-ray and MD ensemble compare to each other? Why do you
think the MD simulation does not sample the x-ray configurations on
the extreme left of the plot (the most open x-ray conformations)? 
And why do you think the twisting mode is sampled with a larger
amplitude in the simulation than in the ensemble of x-ray structures?<p>

Two additional simulations are available for T4 lysozyme, that started
from different x-ray structures. Download the two backbone
trajectories to your local disk: <a
href=md2_backbone.xtc>md2_backbone.xtc</a> and <a
href=md3_backbone.xtc>md3_backbone.xtc</a>. Cross project also these
two trajectories onto the x-ray eigenvectors and visualise all three 
simulations and the ensemble of x-ray structures projected onto the first 
two eigenvectors of the x-ray ensemble.

<p>
<font color=red size=+1> Question: </font>
Which of the three simulations covers most of the crystallographic
structures? Do you consider the simulations long enough to sample the
most relevant conformations of the protein? <p>
<font color=red size=+1> Question: </font>
All three simulations were of the substrate-free protein. Would you
expect a more 'open' or a more 'closed' state as the most probable
configuration in this situation?
<p>
<font color=red size=+1> Question: </font>
Alternatively, we could have carried out a Normal Modes analysis of this
protein, approximating the energy landscape by a multidimensional harmonic
energy minimum. Does the motion along the first PCA eigenvectors appear 
(quasi)-harmonic? If yes, which force-constant would you estimate?
<br> <p>

<a name="optional"></a> <font color=#00c5d0 size=+1>   <h2>D. Optional </h2> </font>

Think back of the first tutorial, where we simulated the noble gas Argon. 
<p>
<font color=red size=+1> Question: </font>
For Argon in the gas phase (without periodic boundary conditions), what kind of results would you expect from a PCA
analysis? Particularly, what would you expect the eigenvalue spectrum to look
like? <p>

Carry out a short simulation of Argon in the gas phase, using this <a
href=topol.top>topology</a>, these  <a
href=argon_gas.pdb>starting coordinates</a>, and these <a
href=md.mdp>MD parameters</a>. Now carry out a PCA over the Argon trajectory:

<h5>gmx covar -s argon_gas.pdb -f traj.xtc -nofit</h5>

<p>
<font color=red size=+1> Question: </font>
Is the eigenvalue spectrum as expected? 
<p>
Have a look at the projections onto the principal eigenvectors with:
<h5>gmx anaeig -s argon_gas.pdb -f traj.xtc -proj -first 1 -last 6</h5>
and
<h5>xmgrace proj.xvg</h5>
<p>
<font color=red size=+1> Question: </font>
Do you note the similarity of these projections to cosines? What implications
does this have for protein trajectories, where the principal mode projections
appear as cosines?<a href=answer5.html> answer</a>.<br>

<br> <p>


<a name="references"></a> <font color=#1a83c4 size=+1> <h2>Further references
    and advanced reading:</h2> </font>
<ul>

<li>  A Kitao and N Go. <EM> Investigating protein dynamics in collective coordinate space</EM> <b> Current Opinion in Structural Biology</b> 9:
  164-169
  (1999). <a href="http://www.sciencedirect.com/science?_ob=ArticleURL&_udi=B6VS6-3WWCKXF-4&_user=38661&_rdoc=1&_fmt=&_orig=search&_sort=d&_docanchor=&view=c&_searchStrId=1122167492&_rerunOrigin=google&_acct=C000003058&_version=1&_urlVersion=0&_userid=38661&md5=872191ea632e9d833240042d61ab2895"> [link] </a>
<br>
<li>  A Amadei, ABM Linssen and HJC Berendsen. <EM> Essential Dynamics of Proteins</EM> <b> PROTEINS: Structure, Function, and Genetics</b> 17:412-425 (1993). <a href="http://www3.interscience.wiley.com/cgi-bin/fulltext/107611161/PDFSTART">   [link] </a>

<li>  Herman JC Berendsen and Steven Hayward  <EM>Collective protein dynamics in relation to function  </EM> <b> Current Opinion in Structural Biology  </b> 10:165-169 (2000). <a href="http://md.chem.rug.nl/local/PAPERS_PDF/2000/MD00.04.pdf">   [link] </a>

<li>  Marcus Kubitzki <EM> Enhanced Conformational Sampling of Proteins Using TEE-REX   </EM> <b>, PhD Thesis, University of Goettingen  </b>, Chapter 4 (2007). <a href="http://webdoc.sub.gwdg.de/diss/2008/kubitzki/kubitzki.pdf">   [link] </a>

</ul>



<p>
Go back to <a href="#contents">Contents</a> 

<hr>
<address>
For questions or feedback please contact <a href="http://www.mpibpc.mpg.de/groups/de_groot/"> Bert de Groot</a> / <a href="mailto:bgroot@gwdg.de">bgroot@gwdg.de</a></address>
<hr>


</body>

</HTML>



